# opencircom-foundry-boilerplate

Minimal [Foundry](https://book.getfoundry.sh/) project that compiles a Circom ZK circuit using [opencircom](https://www.npmjs.com/package/opencircom) and verifies a Groth16 proof on-chain.

## Prerequisites

- [Node.js](https://nodejs.org/) (v18+)
- [circom](https://docs.circom.io/getting-started/installation)
- [Foundry](https://book.getfoundry.sh/getting-started/installation)

## Setup

```bash
npm install
forge install
```

## Commands

| Command | Description |
|--------|-------------|
| `npm run compile:circuits` | Compile `circuits/hello_hash.circom` (Poseidon hash) to R1CS and WASM in `build/`. |
| `npm run setup:zk` | Generate Powers of Tau, zkey, and Solidity verifier in `src/HelloHashVerifier.sol`. |
| `npm run generate:proof` | Generate a sample proof and write `build/proof.json`. |
| `npm test` | Compile circuits, run ZK setup, generate proof, then `forge test`. |

The first `npm test` runs the full ZK setup and can take about a minute.

## Layout

- `circuits/hello_hash.circom` — Example circuit using opencircom’s Poseidon.
- `scripts/compile_circuits.sh` — Compiles with `-l node_modules/opencircom/circuits`.
- `scripts/setup_zk.sh` — ptau, zkey, and verifier generation.
- `scripts/generate_proof.js` — Builds witness and proof; writes `build/proof.json`.
- `src/HelloHashVerifier.sol` — Groth16 verifier (generated by `setup:zk`).
- `src/PoseidonProofGateway.sol` — Example contract that calls the verifier; stores last verified hash on successful `submitProof(...)`.
- `test/HelloHash.t.sol` — Forge tests: direct verifier check and gateway `submitProof` + `lastVerifiedHash` assertion.

## License

MIT
